#!/usr/bin/env bash
set -e


install_zsh() {
    cat << "EOF"
         _     
 _______| |__  
|_  / __| '_ \ 
 / /\__ \ | | |
/___|___/_| |_|
               
EOF
    if ! command -v zsh; then
        sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
    fi
    echo "zsh ok"
}

install_nvim() {
    cat << "EOF"
            _           
 _ ____   _(_)_ __ ___  
| '_ \ \ / / | '_ ` _ \ 
| | | \ V /| | | | | | |
|_| |_|\_/ |_|_| |_| |_|
                        
EOF
    wget https://github.com/neovim/neovim/releases/download/stable/nvim-linux64.deb
    sudo apt install ./nvim-linux64.deb
    rm nvim-linux64.deb
}

install_formatters() {
    cat << "EOF"
  __                            _   _                
 / _| ___  _ __ _ __ ___   __ _| |_| |_ ___ _ __ ___ 
| |_ / _ \| '__| '_ ` _ \ / _` | __| __/ _ \ '__/ __|
|  _| (_) | |  | | | | | | (_| | |_| ||  __/ |  \__ \
|_|  \___/|_|  |_| |_| |_|\__,_|\__|\__\___|_|  |___/
                                                     
EOF
    sudo npm i -g prettier
}

install_utils() {
    cat << "EOF"
             _                      _                         
  __ _ _ __ | |_   _ __   __ _  ___| | ____ _  __ _  ___  ___ 
 / _` | '_ \| __| | '_ \ / _` |/ __| |/ / _` |/ _` |/ _ \/ __|
| (_| | |_) | |_  | |_) | (_| | (__|   < (_| | (_| |  __/\__ \
 \__,_| .__/ \__| | .__/ \__,_|\___|_|\_\__,_|\__, |\___||___/
      |_|         |_|                         |___/           

EOF
    sudo apt update
    sudo apt install \
        zip \
        unzip \
        ripgrep \
        shellcheck \
        tmux \
        figlet

    curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash
}

install_fuck() {
    cat << "EOF"
  __            _    
 / _|_   _  ___| | __
| |_| | | |/ __| |/ /
|  _| |_| | (__|   < 
|_|  \__,_|\___|_|\_\
                     
EOF
    sudo apt install python3-dev python3-pip python3-setuptools
    pip3 install --upgrade pip
    pip3 install thefuck --user
}

install_python() {
    cat << "EOF"
             _   _                 
 _ __  _   _| |_| |__   ___  _ __  
| '_ \| | | | __| '_ \ / _ \| '_ \ 
| |_) | |_| | |_| | | | (_) | | | |
| .__/ \__, |\__|_| |_|\___/|_| |_|
|_|    |___/                       

EOF
    sudo apt install software-properties-common 
    sudo add-apt-repository ppa:deadsnakes/ppa 
    sudo apt update
    sudo apt install python3.10 python3.10-venv python3-pip python3.10-dev
}

install_go() {
    cat << "EOF"
  __ _  ___  
 / _` |/ _ \ 
| (_| | (_) |
 \__, |\___/ 
 |___/       
  
EOF
    if [[ $(go version || true) == 'go version go1.20.3 linux/amd64' ]]; then
        echo up to date
        return
    fi
    go version || true
    wget https://go.dev/dl/go1.20.3.linux-amd64.tar.gz
    sudo rm -rf /usr/local/go
    sudo tar -C /usr/local -xzf go1.20.3.linux-amd64.tar.gz
    go version
}

if [[ $# -eq 0 ]]; then
    echo "zsh nvim py utils fuck go"
fi

while test $# -gt 0
do 
    case "$1" in 
        zsh)
            install_zsh
            ;;
        nvim)
            install_nvim
            ;;
        py)
            install_python
            ;;
        utils)
            install_utils
            ;;
        fuck)
            install_fuck
            ;;
        go)
            install_go
            ;;
        *)
            echo "invalid command: $1"
            ;;
    esac
    shift
done

